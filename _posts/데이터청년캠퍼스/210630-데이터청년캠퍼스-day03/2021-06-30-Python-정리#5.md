---
title: Python ì •ë¦¬ ğŸ’¡5(Functional Programing, Higher Level Function, Closure, Decorator)
date: 2021-07-01 02:27:42 +09:00
modified: 2021-07-01 02:27:42 +09:00
comments: true
tags: [TIL, ë°ì²­ìº , python, 2021, 2107, study, basics]
description: python basics ğŸ’¡5
---

*<span style="color:grey">[python documentation](https://docs.python.org/)</span>*

*<span style="color:grey">Python 3.9ì—ì„œì˜ ì •ë¦¬</span>*

```python
def x():
    print('x')
```

outì´ ì—†ë‹¤ê°€ ì•„ë‹ˆë¼, ë¦¬í„´ê°’ì´ Noneì´ë¼ëŠ” ëœ»

í•¨ìˆ˜ë¥¼ ì •ì˜í•  ë•Œ, ë¦¬í„´ì„ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©´ ìë™ì ìœ¼ë¡œ ë‚´ë¶€ì—ì„œ `return None`ì„ ë¶™í˜€ì£¼ëŠ” í˜•íƒœì™€ ê°™ë‹¤.


```python
class A:
    def __init__(self):
        print('A')
        #ìƒì„±ìë©´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“¤ì–´ì•¼í•˜ëŠ”ë° ì—†ë‹¤?
```

\_\_init\_\_ ìƒì„±ìë„ ìœ„ì˜ í˜•íƒœë¥¼ ë”°ë¼ì„œ `return None`ì„ ìˆ˜í–‰í•œë‹¤.

ì™œ ë°˜í™˜ê°’ì´ ì—†ì„ê¹Œ?

- `initializer` ê°’ì„ ì´ˆê¸°í™” í•˜ëŠ” í˜•íƒœì´ë‹¤
- ë³´í†µ `c++`, `java`ì—ì„œëŠ” `new` ë¡œ `object`ë¥¼ ë§Œë“¤ì—ˆë‹¤.

í•˜ì§€ë§Œ ìƒì„±ìë¼ê³  í•˜ì˜€ëŠ”ë° ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“¤ì§€ ì•ŠëŠ”ë‹¤..


```python
class A:
    def __new__(cls):
        print('NEW')
    def __init__(self):
        print('INIT')
A()
```

    NEW
    


```python
class A:
    def __new__(cls):
        print('NEW')
        return super().__new__(cls) # ì¸ìŠ¤í„´ìŠ¤ê°€ í•˜ë‚˜ ë‚˜ì˜¤ë©´ initì—ì„œ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì´ˆê¸°í™” í•˜ëŠ” í˜•íƒœì´ë‹¤
    def __init__(self):
        print('INIT')
A()
```

    NEW
    INIT
    




    <__main__.A at 0x1aff5610580>



`__new__` ì—ì„œ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±ì„ í•´ì£¼ê³  `__init__`ì´ ì´ˆê¸°í™”ë¥¼ í•´ì¤€ë‹¤.

ê·¸ë˜ì„œ ê°ì²´ë¥¼ 2ê°œ ë™ì‹œì— ë§Œë“¤ê³  ì‹¶ë‹¤ë©´ `__new__`ë¥¼ ì¡°ì‘í•˜ë©´ ëœë‹¤.

# í”„ë¡œê·¸ë˜ë° ë°©ë²•ë¡ 

pythonì€ ë©€í‹° íŒ¨ëŸ¬ë‹¤ì„ ì–¸ì–´ì´ë‹¤?

## python programming paradigm

> python programming paradigm image

- ì„ ì–¸í˜• 
    - ì´ë¯¸ ì„ ì–¸ëœ ì• ë“¤ì„ í†µí•´ì„œ ì›í•˜ëŠ” ê°’ì„ ì–»ëŠ” í˜•íƒœ(ex. SQL)
    
- í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë°
    - html, sqlì²˜ëŸ¼ ì›í•˜ëŠ” ê²ƒì„ ì¡°í•©í•˜ëŠ” ê²ƒì²˜ëŸ¼ í•¨ìˆ˜ë¥¼ ì„ ì–¸ì„ í•´ë†“ê³  ê·¸ê²ƒì˜ ì¡°í•©ì„ ì´ìš©í•˜ì—¬ ì›í•˜ëŠ” ê°’ì„ êµ¬í•˜ëŠ” ë°©ì‹
    - ê°ì²´ì§€í–¥ì—ì„œì˜ í•¨ìˆ˜ì™€ ë‹¤ë¥¸ ì 
        + í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë°ì˜ í•¨ìˆ˜ëŠ” ìˆ˜í•™ì  í•¨ìˆ˜ì—¬ì•¼í•œë‹¤. (inputì„ ì£¼ë©´ outputë¥¼ ìƒì„±í•˜ëŠ” í•¨ìˆ˜)
        + side effectë¥¼ ì—†ì•¤ë‹¤ (í”„ë¡œê·¸ë˜ë°ì„ ë³µì¡í•˜ê²Œ í•˜ê¸° ë•Œë¬¸ì—)
    - ìˆ˜í•™ì  í•¨ìˆ˜ì˜ íŠ¹ì§•
        + ë¼ë©´, `í•©ì„±`ì´ ê°€ëŠ¥í•´ì§„ë‹¤
        + ì¦‰ ë³µì¡í•œ ë‚´ìš©ì„ í•¨ìˆ˜ë¥¼ `í•©ì„±` í•˜ì—¬ ê²°ê³¼ ê°’ì„ ì–»ì„ ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ë°©ì‹  
        + ìˆ˜í•™ì  í•¨ìˆ˜ -> í˜•ì‹ì ìœ¼ë¡œ ì¦ëª…ì´ ê°€ëŠ¥í•˜ë‹¤
        + debuggingí•˜ê¸°, ìœ ì§€ë³´ìˆ˜í•˜ê¸° ìˆ˜ì›”í•˜ë‹¤
        
        + ì–´ë””ì— ë§ì´ ì‚¬ìš©í• ê¹Œ? Theoryì—ì„œ ë°€ì ‘í•˜ê²Œ ì‚¬ìš©ëœë‹¤.
        
pythonì˜ ì² í•™ì— ì¼ë¶€ ë…¹ì•„ë“¤ì–´ê°€ê²Œ ë˜ì—ˆë‹¤.


```python
def x():
    print('x')
    return None
```

ìœ„ì˜ í•¨ìˆ˜ëŠ” inputê³¼ outputì´ ì—†ê¸° ë•Œë¬¸ì— ìˆ˜í•™ì  í•¨ìˆ˜ê°€ ì•„ë‹ˆë‹¤


```python
f(x+2) = f(x+1) + f(x)
```


      File "<ipython-input-8-2c5f3df2850a>", line 1
        f(x+2) = f(x+1) + f(x)
        ^
    SyntaxError: cannot assign to function call
    



```python
# ì¬ê·€ì ìœ¼ë¡œ ìˆ˜í–‰í•˜ëŠ” ìˆ˜í•™ì  í•¨ìˆ˜ì˜ íŠ¹ì§•ì„ ë³´ì—¬ì¤€ë‹¤.
def fi(x):
    if x in [1,2]:
        return 1
    return fi(x-2) + fi(x-1)
```


```python
fi(3)
```




    2



ì™œ ì´ë ‡ê²Œ ì´ìŠˆê°€ ë˜ì—ˆëŠ”ê°€?

- ë”¥ëŸ¬ë‹, ë¹…ë°ì´í„° í•œë²ˆì— ì—¬ëŸ¬ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ëŠ”ë° ìµœì í™” ë˜ì–´ìˆë‹¤.

í•¨ìˆ˜ëŠ” first class function(í•¨ìˆ˜ê°€ ê°’ì²˜ëŸ¼ ì‚¬ìš©ë  ìˆ˜ ìˆë‹¤) ìš°ë³€ì— í•¨ìˆ˜ê°€ ë“¤ì–´ê°ˆ ìˆ˜ë„ ìˆë‹¤.

í•¨ìˆ˜ ìì²´ë¥¼ dataë¡œ ìƒê°í•˜ê³  `recursion`ì„ `loop`ëŒ€ì‹  í™œìš©í•˜ê³  
- `for`, `while`ê³¼ ê°™ì€ `loop`ëŠ” í”„ë¡œê·¸ë¨ì˜ íë¦„ì„ ì˜ íŒŒì•…í•˜ê¸° í˜ë“¤ê¸° ë–„ë¬¸

`ìˆœìˆ˜ í•¨ìˆ˜`
- ì…ë ¥ê°’ê³¼ ì¶œë ¥ê°’ì„ í™•ì¸í•˜ì—¬ ì¦ëª… ê°€ëŠ¥í•˜ë„ë¡ í•œë‹¤.

**ë¬´ì—‡** ì„ ê³„ì‚°í•˜ëŠ”ê°€ê°€ ì•„ë‹ˆë¼ **ì–´ë–»ê²Œ** ê²°ê³¼ê°’ì„ ë‚´ëŠ”ê°€ê°€ ë” ì´ì ì´ ë§ì¶°ì ¸ìˆë‹¤.
(Functional programming worries about *what* is to be computed rather than *how* it is to be computed)

`higher order` í•¨ìˆ˜
- í•¨ìˆ˜ë¥¼ ì¸ìë¡œ ì „ë‹¬ì„ í•  ìˆ˜ ìˆë‹¤.
- tfì˜ ê²½ìš° í•¨ìˆ˜ë¥¼ ë§Œë“¤ê³  í•¨ìˆ˜ë¥¼ ì¸ìë¡œ ì „ë‹¬í•˜ì—¬ ì‚¬ìš©í•œë‹¤.

## Flow Control

### íŠ¹ì§•
1. **Loop**ë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤
- ê°€ì¥ ì‹¤ìˆ˜ê°€ ë§ì´ ë°œìƒí•˜ëŠ” ë¶€ë¶„ì´ë©°, ì´ ë¶€ë¶„ì„ *ì¶”ìƒí™”*ë¥¼ í†µí•´ í•´ê²°í•œë‹¤
- dataë¥¼ í•œê°œë§Œ `loop`í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì—¬ëŸ¬ê°œë¥¼ `loop`í•œë‹¤.

iteratorë€?


```python
import seaborn as sns
import numpy as np
```


```python
iris = sns.load_dataset('iris')
```


```python
dir(iris)
```




    ['T',
     '_AXIS_LEN',
     '_AXIS_ORDERS',
     ...
     '__ipow__',
     '__isub__',
     '__iter__',
     '__itruediv__',
     '__ixor__',
     '__le__',
     '__len__',
     ...
     'where',
     'xs']



`__iter__`ê°€ ì„ ì–¸ì´ ë˜ì–´ ìˆìœ¼ë©´ iterableì´ë¼ê³  ì·¨ê¸‰í•œë‹¤ (duck-typing)

ì–´ë–»ê²Œ í–‰ë™ì„ í•˜ëŠ”ê°€?

- ë‹¤ì–‘í•œ ìë£Œêµ¬ì¡°ì— iterableì´ ë“¤ì–´ê°€ê²Œ ë˜ì–´ìˆë‹¤.
- í–‰ë™ë°©ì‹ì€
    - iterableì´ ë“¤ì–´ê°€ë©´ data í•œ ê°œì´ìƒ ì¡´ì¬í•˜ë©°, ë‚´ë¶€ì ìœ¼ë¡œ ìˆœì„œê°€ ìˆê³ , í•˜ë‚˜ì”© ë½‘í˜€ì„œ ì–´ë–¤ ì‘ì—…ì„ ì²˜ë¦¬í•  ê²ƒì´ë‹¤ë¼ëŠ” ëœ»


```python
# iterable í–‰ë™ë°©ì‹ì˜ ì˜ˆì‹œ
list('abc')
```




    ['a', 'b', 'c']



`iter`ë¼ëŠ” í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ë©´ ì–´ë– í•œ iterableí•œ ê²ƒì„ iteratorë¡œ ë³€í™˜ì„ ì‹œì¼œì¤€ë‹¤

íŒŒì´ì¬ ë‚´ë¶€ì ìœ¼ë¡œ ì„ í–‰ì´ ëœë‹¤.

ì–´ë–¤ íŠ¹ì§•ì„ ê°€ì§€ê³  ìˆëŠ”ê°€?


```python
set(dir(Iterable)) - set(dir(Iterator))
```


    ---------------------------------------------------------------------------

    NameError                                 Traceback (most recent call last)

    <ipython-input-9-97eed6fad678> in <module>
    ----> 1 set(dir(Iterable)) - set(dir(Iterator))
    

    NameError: name 'Iterable' is not defined



```python
set(dir(iterator))- set(dir(iterable))
```

`__next__`ê°€ í•µì‹¬ì ì¸ ì°¨ì´ë¼ëŠ” ê²ƒì„ ì°¾ì„ ìˆ˜ ìˆë‹¤


```python
t = iter('abc')
```


```python
next(t)
```




    'a'




```python
t.__next__()
```




    'b'




```python
t.__next__() # 'c'
t.__next__() # ë”ì´ìƒ ì—†ëŠ” ê²½ìš°?
```


    ---------------------------------------------------------------------------

    StopIteration                             Traceback (most recent call last)

    <ipython-input-16-e91626383035> in <module>
          1 t.__next__() # 'c'
    ----> 2 t.__next__() # ë”ì´ìƒ ì—†ëŠ” ê²½ìš°?
    

    StopIteration: 


iterë¼ê³  í•˜ëŠ” ìˆœê°„ ë©”ëª¨ë¦¬ì— ì „ì²´ ë°ì´í„°ë¥¼ ì ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤.

100ë§Œê°œë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤ê³  í•˜ì—¬ë„, ë©”ëª¨ë¦¬ì— ì˜¬ë¼ê°€ì§€ ì•Šê³  `next()`ë¥¼ ìˆ˜í–‰ì„ í•´ì£¼ë©´ ê·¸ë•Œì—ì„œì•¼ ë©”ëª¨ë¦¬ìƒì— ì˜¬ë¼ê°„ë‹¤ **(lazy ê¸°ë²•)**
- ì•„ì£¼ ë§ì€ ë°ì´í„°ë¥¼ ë©”ëª¨ë¦¬ì— ì˜¬ë¦¬ëŠ” ê²ƒì€ ë¹„íš¨ìœ¨ì ì´ê¸° ë•Œë¬¸


```python
t = iter(iris)
```


```python
t[0]
```


    ---------------------------------------------------------------------------

    TypeError                                 Traceback (most recent call last)

    <ipython-input-18-a471f56f22a6> in <module>
    ----> 1 t[0]
    

    TypeError: 'map' object is not subscriptable


í•˜ë‚˜ë§Œ ì ì¬ë¥¼ í•˜ê¸° ë–„ë¬¸ì— í™•ì¸ì„ í•  ìˆ˜ ì—†ë‹¤!


```python
next(t)
```




    'sepal_length'




```python
iris.columns
```




    Index(['sepal_length', 'sepal_width', 'petal_length', 'petal_width',
           'species'],
          dtype='object')



ì–´ë–¤ êµ¬ì¡°ë¡œ ì´ë£¨ì–´ì ¸ìˆëŠ”ì§€ ëª¨ë¥´ê¸° ë•Œë¬¸ì— ì‚¬ìš©ìê°€ í™•ì¸ì„ í•´ë´ì•¼í•œë‹¤.

`__iter__`ê°€ `dir()` í†µí•´ì„œ ì°¾ì„ ìˆ˜ ìˆë‹¤ë©´, `iterable`í•˜ë‹¤ëŠ” ëœ»ì´ë‹¤

`for i in `
- ë’¤ì—ëŠ” iterableì´ ë“¤ì–´ê°„ë‹¤

ì¦‰ í•¨ìˆ˜í˜• íŒ¨ëŸ¬ë‹¤ì„ìœ¼ë¡œ ë§Œë“¤ì–´ì¡Œë‹¤ëŠ” ê²ƒì„ ìœ ì¶”í•  ìˆ˜ ìˆë‹¤. 
- *whileì€ í•´ë‹¹ë˜ì§€ ì•ŠìŒ(ë¬´í•œ ë£¨í”„ë¥¼ ì œì™¸í•˜ê³ ëŠ” í™œìš© í•˜ì§€ ì•ŠëŠ”ê²Œ ì¢‹ë‹¤.)*


```python
for i in iris:
    print(i)
```

    sepal_length
    sepal_width
    petal_length
    petal_width
    species
    

pythonì˜ how-toì—ì„œ í•¨ìˆ˜í˜• íŒ¨ëŸ¬ë‹¤ì„ìœ¼ë¡œ ë³´ì—¬ì£¼ë©° loopë¥¼ ì“°ì§€ ì•Šì€ ì˜ˆì‹œë¥¼ ë³´ì—¬ì¤€ë‹¤.

## Encapsulation

- *How*ë³´ë‹¤ *What*ê°€ ì¤‘ìš”í•˜ë‹¤ê³  í•˜ì˜€ëŠ”ë°
- ë¬´ìŠ¨ ê¸°ëŠ¥ì„ í•˜ëŠ” í•¨ìˆ˜ë¥¼ ë§Œë“ ë‹¤.
- ìº¡ìŠí™”ì˜ ì¥ì 
    + í•¨ìˆ˜ë¡œ ë§Œë“¤ì–´, ì¬í™œìš©ì´ ê°€ëŠ¥í•˜ë‹¤ (ì¬ì‚¬ìš©ì˜ ìœ ì—°ì„± ì œê³µ)
- ë‘ë²ˆì´ìƒ ë°˜ë³µì´ ëœë‹¤ë©´ í•¨ìˆ˜ë¡œ ë°”ë¡œ ì‚¬ìš©ì„ í•œë‹¤.

```python
# configure the data to start with
collection = get_initial_state()
state_var = None
    for datum in data_set:
    if condition(state_var):
        state_var = calculate_from(datum)
        new = modify(datum, state_var)
        collection.add_to(new)
    else:
        new = modify_differently(datum)
        collection.add_to(new)
# Now actually work with the data
for thing in collection:
    process(thing)
```
ë¥¼

```python
# tuck away construction of data
def make_collection(data_set):
    collection = get_initial_state()
    state_var = None
    for datum in data_set:
        if condition(state_var):
            state_var = calculate_from(datum, state_var)
            new = modify(datum, state_var)
            collection.add_to(new)
    else:
        new = modify_differently(datum)
        collection.add_to(new)
    return collection
# Now actually work with the data
for thing in make_collection(data_set):
    process(thing)
```
ë¡œ `Encapsulation`ì„ í•˜ì˜€ë‹¤.

ì—¬ê¸°ì„œ ë”ìš± í•¨ìˆ˜í˜• íŒ¨ëŸ¬ë‹¤ì„ìœ¼ë¡œ ì‘ì—…ì„ í•´ë³´ê¸° ìœ„í•´ì„œ `for`ë£¨í”„ë¥¼ ë°”ê¿”ë³´ì.

í•˜ì§€ë§Œ ì´ ê³¼ì •ì€ ìƒê°ë§Œí¼ ì‰½ì§€ ì•Šê³ , ê°„ë‹¨í•˜ê²Œ í•˜ëŠ” ë°©ë²•ì´ ì¡´ì¬í•œë‹¤.

## Comprehension


```python
temp = []
for i in range(10):
    temp.append(i)
```


```python
temp
```




    [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]




```python
i
```




    9




```python
# comprehension ë°©ì‹
temp2 = [i for i in range(15)]
```


```python
temp2
```




    [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]




```python
i
```




    9




```python
import time
start = time.time()
temp = []
for i in range(10000000):
    temp.append(i)
fin = time.time()
print(fin - start)
[i for i in range(10000000)]
print("comprehension time took : "time.time() -fin)
```

    2.2235660552978516
    0.9001858234405518
    

- `Haskell`ì—ì„œ ì˜¨ ê°œë…

### comprehensionì˜ ì¥ì 
- ê´„í˜¸ ì•ˆì—ì„œ `i`ë¥¼ ë”°ë¡œ ê´€ë¦¬í•œë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.
    + ì—¬ê¸°ì„œ ì‹¤ìˆ˜ê°€ ë°œìƒ í™œ ìˆ˜ ìˆìŒ
- ìµœì í™”ê³¼ ë˜ì–´ìˆì–´ ì†ë„ê°€ ë¹ ë¥´ë‹¤
- ì½”ë“œê°€ ì§§ê³  ê°„ê²°í•˜ë‹¤

### comprehensionì˜ ì¢…ë¥˜
- list ë°©ì‹
- dictionary ë°©ì‹
- set ë°©ì‹


```python
# ifë¬¸ í™œìš© ì˜ˆì‹œ
[i for i in range(10) if i%2==0]
```




    [0, 2, 4, 6, 8]




```python
# ifë¬¸ì„ ë‹¤ìŒê³¼ ê°™ì€ í˜•íƒœë¡œë„ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤
[i if i%2==0 else '' for i in range(10)]
```




    [0, '', 2, '', 4, '', 6, '', 8, '']




```python
# ì¤‘ì²©ë„ ê°€ëŠ¥í•˜ë‹¤
[(i,j) for i in range(1,5) for j in range(6,11)]
```




    [(1, 6),
     (1, 7),
     (1, 8),
     (1, 9),
     (1, 10),
     ...
     ...
     (4, 7),
     (4, 8),
     (4, 9),
     (4, 10)]



ì´ ë°©ì‹ì„ í™œìš©í•˜ë©´ ìœ„ì˜ ì˜ˆì‹œì—ì„œ
```python
collection = list()
for datum in data_set:
    if condition(datum):
        collection.append(datum)
    else:
        new = modify(datum)
        collection.append(new)
```
ê°€
```python
collection = [d if condition(d) else modify(d) for d in data_set]
```

ë‹¤ìŒê³¼ ê°™ì´ ì§§ê³  ê°„ë‹¨í•˜ê²Œ ì •ë¦¬ê°€ ë˜ì–´ìˆë‹¤.


```python
# ë§Œì•½ì— ë°ì´í„°ê°€ ì˜ëª» ë˜ì–´ìˆì–´ 1ì”© ë”í•´ì•¼í•œë‹¤ê³  í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ ê°„ë‹¨í•˜ê²Œí•œë‹¤.
[i+1 for i in iris.sepal_length]
```




    [6.1,
     5.9,
     5.7,
     5.6,
    ...
    ...
    ...
     7.7,
     7.7,
     7.3,
     7.5,
     7.2,
     6.9]




```python
# comprehensionê¼´ì„ tupleë¡œ ì§„í–‰í•˜ë©´, generator expression
a = (i for i in range(10))
```


```python
print(a)
```

    <generator object <genexpr> at 0x00000248BB4E6200>
    


```python
next(a)
```




    0



`tuple`ê³¼ `list`, `set`, `dict`ê³¼ì˜ ë‹¤ë¥¸ íŠ¹ì§•ì€ immutableí•˜ë‹¤ëŠ” ê²ƒ

iteratorì˜ ì‚¬ì´Œê²©, generator

### Generator

ë§Œë“œëŠ” ë°©ì‹ì€ ë‹¤ë¥´ì§€ë§Œ ë˜‘ê°™ì€ í–‰ë™ì„ í•œë‹¤. nextë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

ë§Œë“œëŠ” ë°©ì‹ì´ 4ê°€ì§€ ì¡´ì¬í•œë‹¤

1. comprehension ë°©ì‹
    - `(i for i in range(10))`
2. í•¨ìˆ˜ì²˜ëŸ¼ ìƒì„±ì„ í•˜ëŠ” ê²ƒ
    - `next`í•  ë•Œë§ˆë‹¤, í•˜ë‚˜ì”© ì¶œë ¥ì´ ëœë‹¤.
    - ê´€ë¡€ì ìœ¼ë¡œ ì‚¬ìš©í•˜ì§„ ì•ŠëŠ”ë‹¤.
```python
def ge():
    yield 1
    yield 2
g = gen()
print(g)
# <generator object gen at 0x00000248BB53F6D0>
```
3. duck typing
    - `__iter__` ë“±ì„ ì •ì˜í•´ì¤€ë‹¤.
4. ìƒì†

    - ì´ë ‡ê²Œ ë‚˜ì—´ì‹ ì´ì™¸ì—ë„ ê°€ëŠ¥í•œ ë°©ì‹ì€ ì•„ë˜ì™€ ê°™ë‹¤


```python
def gen():
    yield from [1,2,3,]
```


```python
g = gen()
```


```python
next(g)
```




    1



- `return`ì„ ì¨ë²„ë¦¬ë©´ `yield`ì´ì „ì— ì‚¬ìš©ì„ í•œë‹¤ë©´, 0ì„ ë°˜í™˜í•˜ì˜€ê¸° ë•Œë¬¸ì—, `StopIteration`ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤.
- ì´ë•Œ `StopIteration` ì—ëŸ¬ëŠ” ë°˜í™˜ ê°’ìœ¼ë¡œ ë‚˜ì˜¤ê²Œ ëœë‹¤.
- `try~except` êµ¬ë¬¸ì„ ì´ìš©í•˜ì—¬ ì—ëŸ¬ì²˜ë¦¬ë¥¼ í•  ìˆ˜ ìˆë‹¤ëŠ” ëœ»ì´ ëœë‹¤.


```python
def gen():
    return 'hello'
    yield from [1,2,3,]
```


```python
g = gen()
next(g)
```


    ---------------------------------------------------------------------------

    StopIteration                             Traceback (most recent call last)

    <ipython-input-72-0827313a2fe6> in <module>
          1 g = gen()
    ----> 2 next(g)
    

    StopIteration: hello



```python
%%writefile a.txt
this is test
a.txt writing
```

    Writing a.txt
    


```python
x = open('a.txt')
```


```python
'__iter__'in dir(x)
```




    True




```python
next(x)
```




    'this is test\n'




```python
x.readline()
```




    'a.txt writing\n'



í•œ ì¤„ ë¶€ë¥¼ ë•Œë§ˆë‹¤ ë©”ëª¨ë¦¬ ì „ì²´ ë‹¤ ì˜¬ë¦¬ë©´ ë¹„íš¨ìœ¨ì ì´ë¯€ë¡œ í•œ ì¤„ì”© ì½ëŠ” ê²ƒ.

`readline`í•¨ìˆ˜ëŠ” ë‚´ë¶€ì ìœ¼ë¡œ `next`ë¥¼ ìˆ˜í–‰í•´ì¤€ë‹¤.

ì´ëŸ° ë°©ì‹ê³¼ ìœ ì‚¬í•˜ê²Œ `python`ë‚´ ìˆ˜ ë§ì€ ê³³ì—ì„œ ì‚¬ìš©í•œë‹¤.


```python
('__enter__' in dir(x), '__exit__' in dir(x))
```




    (True, True)



`__enter__`ê°€ ì¡´ì¬í•œë‹¤ë©´ `with` êµ¬ë¬¸ì„ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ëœë‹¤.


```python
with open('a.txt') as x:
    pass
```


```python
class T:
    def __enter__(self):
        print('enter')
    #def __exit__(self):
    #    print('exit')
```


```python
with T():
    pass 
```


    ---------------------------------------------------------------------------

    AttributeError                            Traceback (most recent call last)

    <ipython-input-95-808f68ec0c87> in <module>
    ----> 1 with T():
          2     pass
    

    AttributeError: __exit__


enter ì™€ exitì€ ì§ìœ¼ë¡œ ì¡´ì¬í•´ì•¼í•˜ë©°


```python
class T:
    def __enter__(self):
        print('enter')
    def __exit__(self,b,c,d):
        print('exit')
        
```


```python
with T():
    print('t')
```

    enter
    t
    exit
    

ì§ì´ ì§€ì–´ì ¸ ìˆë‹¤ëŠ” ê²ƒì€ ë™ì‹œì— ì‹¤í–‰ì´ ëœë‹¤ëŠ” ê²ƒì´ê³ 

ë‹¤ìŒê³¼ ê°™ì´ `enter`, ì›í•˜ëŠ” ë©”ì„¸ì§€, `exit`ì´ ë‚˜ì˜¤ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

`open`ì„ í•œ í›„ì— `close`ë¥¼ í•˜ì§€ ì•Šì•„ë„ í•´ë‹¹ ë¶€ë¶„ì´ ì¢…ë£Œë˜ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.

*context manager*ë¼ê³  ë¶€ë¥¸ë‹¤

<br>

`with`ê°€ ìˆê±°ë‚˜, `with`ë¼ë¦¬ ì¤‘ì²©ì´ ë˜ì–´ ìˆë‹¤ëŠ” ê²ƒì€ íŠ¹ë³„í•œ ì˜ë¯¸ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤.

```python
with T() as t, S() as f:
    print('t')
```

ëŠ” ì•„ë˜ì™€ ë™ì¼í•œ íš¨ê³¼ë¥¼ ë‚´ëŠ” syntax sugarì´ë‹¤.

```python
with T() as t:
    with S() as f:
```

ë™ì¼í•˜ë‹¤.

`yield`ë¥¼ ìì£¼ ì‚¬ìš©ì„ í•˜ê²Œë˜ëŠ”ë°

#### ì™œ ì´ê²ƒì„ ë§ì´ ì“¸ê¹Œ?

- ì •í˜•ë°ì´í„°ë‚˜ ë¹„ì •í˜•ë°ì´í„°, ì‹ í˜¸ë°ì´í„°ëŠ” ë‹¤ ë‹¤ë¥´ê²Œ ì…ë ¥ì„ ë°›ì•„ì•¼í•˜ëŠ”ë°,
- ì•„ì£¼ í° ë°ì´í„°ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬í•˜ëŠ”ë° ìˆì–´ì„œ íš¨ìœ¨ì ì¸ ìë£Œêµ¬ì¡°ë¡œ ì˜®ê¸°ëŠ” ê³¼ì •ì—ì„œ ë§ì´ ì“°ì¸ë‹¤.

**? ë§Œì•½ì— í•˜ë‚˜ë§Œ ì“°ê³  ì‹¶ë‹¤ë©´ ?**

`break` ì‚¬ìš©í•˜ë©´ ëœë‹¤. 

iteratorë¡œ ë°”ë€Œì–´ì„œ ì§„í–‰ì„ í•˜ê¸°ì— ì†ë„ë‚˜ íš¨ìœ¨ì„±ì—ì„œ ë¬¸ì œëŠ” ì—†ì§€ë§Œ í•¨ìˆ˜í˜• íŒ¨ëŸ¬ë‹¤ì„ì—ì„œëŠ” ì¢‹ì•„í•˜ì§€ ì•ŠëŠ”ë‹¤.

pipelineì„ êµ¬ì¶•í•  ë•Œ, ì´ëŸ° ê²ƒì„ ì§¤ ì¤„ ì•Œì•„ì•¼í•œë‹¤.

```python
class GetLogLines(object):
    def __init__(self, log_file):
        self.log_file = log_file
        self.line = None
    def __iter__(self):
        return self
    def __next__(self):
        if self.line is None:
            self.line = read_line(log_file)
        while not complex_condition(self.line):
            self.line = read_line(self.log_file)
        return self.line

log_lines = GetLogLines(huge_log_file)
```

# python recursion
 
ë‹¤ë¥¸ í•¨ìˆ˜í˜• íŒ¨ëŸ¬ë‹¤ì„ì€ ê¸°ë³¸ì´ recursionì´ì—¬ì„œ íš¨ìœ¨ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ë° ë°˜ë³µë˜ê²Œ `stack`ì— ìŒ“ì´ë‹¤ ë³´ë©´ ìˆ˜í–‰ì‹œê°„ì´ ë§¤ìš° ëŠë¦¬ë‹¤.

MROì²˜ëŸ¼ ë‹¤ì–‘í•œ ê°€ì§€ì¹˜ê¸°ë¥¼ í•˜ë‚˜ì˜ ì„ ìœ¼ë¡œ Linearlizationí•˜ëŠ” ê¸°ë²•ì´ ìˆëŠ”ë° ì´ê²ƒê³¼ ìœ ì‚¬í•œ ë°©ì‹ì´ í•„ìš”í•˜ë‹¤.

ì´ *tail recursion elimination*ì„ í†µí•´ì„œ í•´ê²°í•˜ëŠ”ë°, ì´ëŠ” recursionì—ì„œ ë°˜ë³µë˜ëŠ” ì—°ì‚°ì„ í•œë²ˆë§Œ í•˜ê²Œ í•´ì£¼ê¸° ë–„ë¬¸ì— ì†ë„ê°€ ë¹¨ë¼ì§€ëŠ”ë°

`python`ì€ ì´ê²ƒì„ ì§€ì›í•´ì£¼ì§€ ì•Šì•„ ì†ë„ê°€ ë§¤ìš° ëŠë¦¬ë‹¤.

- ê·¸ë˜ì„œ ì´ ë¶€ë¶„ì„ ì§ì ‘ êµ¬í˜„í•´ì„œ ì‘ì—…ì„ í•œë‹¤.

ë‹¤ë¥¸ ì–¸ì–´ì—ì„œëŠ” gradient descentë¥¼ ì¬ê·€í˜•íƒœë¡œ ë§Œë“¤ì§€ë§Œ pythonì—ì„œëŠ” ì¬ê·€ ì‚¬ìš©í•œë‹¤.


```python
%%timeit
def factorialR(N):
    "Recursive factorial function"
    assert isinstance(N, int) and N >= 1
    return 1 if N <= 1 else N * factorialR(N-1)

factorialR(100)
```

    34.2 Âµs Â± 2.81 Âµs per loop (mean Â± std. dev. of 7 runs, 10000 loops each)
    


```python
%%timeit
def factorialI(N):
    "Iterative factorial function"
    assert isinstance(N, int) and N >= 1
    product = 1
    while N >= 1:
        product *= N
        N -= 1
    return product

factorialI(100)
```

    18.9 Âµs Â± 2.38 Âµs per loop (mean Â± std. dev. of 7 runs, 100000 loops each)
    


```python
34.2 / 18.9
```




    1.8095238095238098




```python
%%timeit
from functools import reduce
from operator import mul
def factorialHOF(n):
    return reduce(mul, range(1, n+1), 1)

factorialHOF(100)
```

    10.6 Âµs Â± 1.35 Âµs per loop (mean Â± std. dev. of 7 runs, 100000 loops each)
    

ë©”ëª¨ë¦¬ê°€ ë¶€ì¡±í• ë•Œ, ì†ë„ê°€ ëŠë¦´ë•Œ ë§ˆë‹¤ ê¸°ë²•ì„ ë‹¤ë¥´ê²Œ ì ìš©í•´ì•¼í•˜ë¯€ë¡œ ì•Œë©´ ì¢‹ìŒ

#### recursionì€ ë‘˜ ë‹¤ ì•ˆì¢‹ê¸° ë•Œë¬¸ì— ì“°ì§€ ì•ŠëŠ”ë‹¤.

pythonì€ ëª¨ë“  ì—°ì‚°ìì— í•´ë‹¹í•˜ëŠ” `function`ì´ ì¡´ì¬í•œë‹¤

ì¦‰, í•¨ìˆ˜í˜• íŒ¨ëŸ¬ë‹¤ì„ìœ¼ë¡œ ëª¨ë“  ì—°ì‚°ìë“¤ì„ í•©ì„±í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

```python
from functools import reduce
from operator import mul
def factorialHOF(n):
    return reduce(mul, range(1, n+1), 1)
```

# ê³ ì°¨í•¨ìˆ˜

## map

`map(self, /, *args, **kwargs)`

`map(func, *iterables) -> map object`
- í•¨ìˆ˜ì™€ iterablesë¥¼ ì…ë ¥ìœ¼ë¡œ ë°›ì•„ì„œ map objectë¥¼ ë°˜í™˜í•œë‹¤.
- ì‘ì—…
    - ëª¨ë“  ì›ì†Œì— ëŒ€í•´ì„œ ëŒ€í•­ í•¨ìˆ˜ ì‘ì—…ì„ ìˆ˜í–‰
    
    
 
```python
t = iter(map(lambda x:x+1, [1,2,3,4,5]))
# iterë¥¼ ì´ìš©í•´ì„œ í™•ì¸ í•  ìˆ˜ ìˆë‹¤
next(t) 
# ë°˜ë³µí•˜ë©´
# 2 3 4 5 6
```


```python
'__iter__' in dir(map) # __iter__, __next___ ì¡´ì¬
```




    True




```python
t = map(lambda x:x+1, [1,2,3,4,5])
```


```python
next(t)
```




    2




```python
list(t)
```




    [3, 4, 5, 6]



**ìˆœì„œê°€ ì¤‘ìš”í•˜ë‹¤**


```python
t = list(map(lambda x,y:x+y , [1,2,3,4,5], [5,4,3,2,1]))
```


```python
t
```




    [6, 6, 6, 6, 6]



ë‹¤ìŒê³¼ ê°™ì´ í™•ì¥ì‹œí‚¬ ìˆ˜ ìˆë‹¤. ë¬´í•œì • ëŠ˜ì–´ë‚  ìˆ˜ ìˆë‹¤!

## filter

`filter(self, /, *args, **kwargs)`

`filter(function or None, iterable) --> filter object`

-ì¡°ê±´ì— Trueì¸ ì• ë“¤ë§Œ ë½‘ì•„ì„œ ë¦¬í„´í•œë‹¤.

**predicate function**ì´ í•„ìˆ˜ë¡œ ë“¤ì–´ê°€ì•¼í•œë‹¤

```python
t = filter(lambda x:x>3, [1,2,3,4,5])
next(t)
# 4 5
```

bad example
```pyhotn
temp = []
for i in [1,2,3,4,5]
    if i>3:
        temp.append(i)
```

- ì•„ë˜ë¥¼ ì°¸ì¡°í•´ë³´ë©´ ì‹œê°„ì˜ ì°¨ì´ ê·¸ë¦¬ê³  ì½”ë“œì˜ ê°„ë‹¨í•¨ì—ì„œ ë§¤ìš° í° ì°¨ì´ë¥¼ í™•ì¸ í•  ìˆ˜ ìˆë‹¤.



```python
%%timeit
temp = []
for i in range(1,10000000):
    if i>3:
        temp.append(i)
```

    1.53 s Â± 26.2 ms per loop (mean Â± std. dev. of 7 runs, 1 loop each)
    


```python
%%timeit
t = filter(lambda x:x>3, range(1,10000000))
```

    564 ns Â± 44.6 ns per loop (mean Â± std. dev. of 7 runs, 1000000 loops each)
    

## reduce

`from functools import reduce`

`reduce(function, sequence[, initial]) -> value`

- reductionì„ í•˜ë©°, ê²°ê³¼ë¥¼ í•˜ë‚˜ì˜ ê°’ìœ¼ë¡œ í‘œí˜„í•´ì£¼ëŠ” ê¸°ìˆ ì´ë‹¤

```python
reduce(lambda x,y:x+y, [1,2,3,4,5])
# Out : 15
```

reduce ì—°ì‚°ì€ ë‹¤ìŒê³¼ ê°™ì´ ì§„í–‰ì´ ë˜ì–´ `x,y : x+y` í˜•íƒœë¡œ ë˜ì–´ì•¼í•œë‹¤.

\[1,2,3,4,5\] ë¥¼ ì˜ˆì‹œë¡œ ê°€ì§„ë‹¤ë©´
- x = 1, y = 2 ì„ ë”í•´ ìƒˆë¡œìš´ sequnceë¥¼ ê°€ì§„ë‹¤ x+y = 3
    + \[3,3,4,5\] 
- x = 3, y = 3 / x+y = 6
    + \[6,4,5\]
- x = 6, y = 4 / x+y = 10
    + \[10,5\]
- x = 10, y = 5 / x+y = 15
    + \[15\]
    
> ì•„ë˜ì˜ ì˜ˆì‹œë¥¼ ì´í•´í•´ë³´ë„ë¡í•˜ì


```python
from functools import reduce
```


```python
# let f1, f2, f3 (etc) be functions that perform actions
# an execution utility function
do_it = lambda f, *args: f(*args)
# map()-based action sequence
# map(do_it, [f1, f2, f3])
```


```python
hello = lambda first, last: print("Hello", first, last)
bye = lambda first, last: print("Bye", first, last)
_ = list(map(do_it, [hello, bye], ['David','Jane'], ['Mertz','Doe']))
```

    Hello David Mertz
    Bye Jane Doe
    


```python
do_all_funcs = lambda fns, *args: [list(map(fn, *args)) for fn in fns]
_ = do_all_funcs([hello, bye],['David','Jane'], ['Mertz','Doe'])
```

    Hello David Mertz
    Hello Jane Doe
    Bye David Mertz
    Bye Jane Doe
    

ì¶”ìƒí™”í•˜ì—¬ ê°„ê²°í•˜ê³  ì •ë¦¬ê°€ ëœ ì½”ë“œì™€ ë¹ ë¥¸ ì‹¤í–‰ ì†ë„ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆë‹¤.

ê·¸ ì›ì¸ì´ functional programming ìì²´ê°€ íƒœìƒì ìœ¼ë¡œ ì—¬ëŸ¬ê°œì˜ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ëŠ”ë° ì§‘ì¤‘ë˜ì–´ ìˆê¸° ë–„ë¬¸ì—

# Callable

- í•¨ìˆ˜
- í´ë˜ìŠ¤
- `__call()__`ì´ ìˆì„ë•Œ


```python
import tensorflow as tf
```


```python
model = tf.keras.applications.VGG16()
```


```python
'__call__' in dir(model)
```




    True



í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë°ê³¼ ê°ì²´ì œí–¥ì˜ ê²½ê³„ë¥¼ í¬ë¯¸í•˜ê²Œ í•´ì¤€ë‹¤ 

modelì„ `dir()`í•˜ì—¬ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì°¾ì•„ë³´ë©´ `__call__`ì´ ì¡´ì¬í•˜ëŠ”ë°,

ì´ ë§ì€ ì¦‰ìŠ¨ `instance`ë„ `callable`í•˜ë„ë¡ ë§Œë“¤ì–´ì¤€ë‹¤.

## lambda


```python
def x():
    return 1
```


```python
x.__qualname__ # qualnameì´ë‘ nameì€ ê±°ì˜ ë¹„ìŠ·í•˜ë‹¤ qualnameì´ íŠ¹ì§•ì„ ë” ë³´ì—¬ì¤Œ
```




    'x'




```python
y = lambda :1
```


```python
y.__qualname__
```




    '<lambda>'




```python
print(x(), y())
```

    1 1
    

ë‹¤ìŒê³¼ ê°™ì´ ê°™ì€ ê²°ê³¼ë¥¼ ë³´ì´ì§€ë§Œ
- íœ˜ë°œì„±, ë©”ëª¨ë¦¬ì— ì ì¬ë˜ì§€ ì•ŠëŠ” í•¨ìˆ˜ì¸ ëŒë‹¤í•¨ìˆ˜ëŠ” ì´ë¦„ì´ <lambda>ë¡œ ëœë‹¤.

## Closure


```python
# closureì˜ í•¨ìˆ˜ í˜•íƒœ
def x(t):
    def y(n):
        return t+n
    return y
```


```python
x(3)(5)
```




    8




```python
# closureì˜ í´ë˜ìŠ¤ í˜•íƒœ
class X:
    def __init__(self, m):
        self.m = m
    def __call__(self,n): # instanceë¥¼ callableí•˜ê²Œ ë§Œë“¤ì–´ì¤€ë‹¤ / ê´„í˜¸ë¥¼ ì‚¬ìš©ê°€ëŠ¥í•´ì§„ë‹¤.
        return self.m + n
```


```python
X(3)(4)
```




    7



- ìœ„ì˜ 2ê°œëŠ” ë˜‘ê°™ë‹¤.
- ë‘ ê°œì˜ ì¡°í•©ìœ¼ë¡œ ë‹¤ë¥¸ í•¨ìˆ˜ë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤
- ì²«ë²ˆì©¨ ì¸ìì— ë”°ë¼ì„œ ë™ì ìœ¼ë¡œ ë³€í•˜ëŠ” í•¨ìˆ˜ë¥¼ ìƒì„±í•˜ëŠ” ê²°ê³¼


```python
add3 = X(3)
```


```python
add3(5)
```




    8



## closure ì¥ì 

- ì…ë ¥ì— ë”°ë¼ì„œ ìœ ê¸°ì ìœ¼ë¡œ ë³€í•˜ëŠ” í•¨ìˆ˜ë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤

ex) tensorflowì—ì„œ ëª¨ë¸ì„ ë§Œë“œëŠ” ë²• 6ê°€ì§€ê°€ ì¡´ì¬í•˜ëŠ”ë°
- Sequential
- Model
- Subclass
- Module
- Estimator
- tf.nn
    + Modelì€ ì „ë¬¸ê°€ìš©ìœ¼ë¡œ ê°€ì¥ __ìœ ì—°í•˜ê²Œ__ ë§Œë“¤ ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤.

# Decorator

pythonì—ì„œ ì¡´ì¬í•˜ëŠ” ì•„ì£¼ ê°•ë ¥í•œ ê¸°ëŠ¥ìœ¼ë¡œ ì´ë¯¸ ì •ì˜ë˜ì–´ìˆëŠ” í•¨ìˆ˜ì— ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©ëœë‹¤.

ìµœì†Œí•œ 2ê°œ ì¤‘ì²©í•œ êµ¬ì¡°ì—ì„œ ì²«ë²ˆì¨° ì¸ìë¥¼ í•¨ìˆ˜ë¡œ ë°›ê³  ê·¸ í•¨ìˆ˜ë¥¼ ì¤‘ì²©ëœ í•¨ìˆ˜ ì•ˆì—ì„œ ë³€í˜„ë˜ê²Œ ì‹¤í–‰ì‹œí‚¨ë‹¤.


```python
# element-wiseí•œ ì—°ì‚°ì„ ì§€ì› *vectorizeation*
import numpy as np
```


```python
def add(x,y):
    return x+y

add([1,2,3],[4,5,6])
```




    [1, 2, 3, 4, 5, 6]




```python
@np.vectorize
def add_vec(x,y):
    return x+y

add_vec([1,2,3],[4,5,6])
```




    array([5, 7, 9])



### decoratorë¥¼ ì–¸ì œì‚¬ìš©í•˜ëŠ”ê°€?
- ê¸°ì¡´ì˜ í•¨ìˆ˜ê°€ ìˆëŠ”ë°, ê¸°ëŠ¥ì„ ì¶”ê°€ë¥¼ í•˜ê³ ì‹¶ì„ë•Œ

ê´€ì  **2ê°€ì§€** ì¡´ì¬
1. ê¸°ëŠ¥ì´ ë¶€ì¡±í•œ í•¨ìˆ˜ë¥¼ ë³´ì•ˆí•˜ëŠ” í˜•íƒœ
2. ì´ë¯¸ êµ¬í˜„ëœ í•¨ìˆ˜ì— ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ëŠ” í˜•íƒœ

closureí•˜ê³  ìœ ì‚¬í•œ ì¡°ê±´ì´ ìˆë‹¤
- closure êµ¬í˜„ì‹œ ì´ì¤‘êµ¬ì¡°ì—ì„œ ì²«ë²ˆì§¸ ì¸ìê°€ í•¨ìˆ˜ì´ë‹¤.
- ì´ í•¨ìˆ˜ë¥¼ ë‚´ë¶€ í•¨ìˆ˜ ì•ˆì—ì„œ ì‹¤í–‰í•œë‹¤

### decoratorì˜ ê¸°ë³¸ ë¼ˆëŒ€

```python
def x(fun):
    def y():
        fun()
        pass
    return y
```


```python
# ì˜ˆì‹œ
def x(fun):
    def y():
        print("----")
        fun()
        print("----")
    return y
```


```python
def t():
    print("closure example")
```


```python
x(t)() 
```

    ----
    closure example
    ----
    

ì›ë˜ tí•¨ìˆ˜ëŠ” "closure example"ë¥¼ ì¶œë ¥í•˜ëŠ” í•¨ìˆ˜ì˜€ì§€ë§Œ

xí•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ ì¤„ì„ ê·¸ì–´ì£¼ëŠ” í˜•íƒœë¡œ ë³€ê²½ ë˜ì—ˆë‹¤.

ì—¬ê¸°ì„œ decoratorë¥¼ ì‚¬ìš©í•œë‹¤ë©´


```python
@x
def t():
    print("decorator example")
```


```python
t()
```

    ----
    decorator example
    ----
    

ë°”ë¡œ tí•¨ìˆ˜ì— ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ëŠ” í˜•íƒœë¡œ ì‚¬ìš©ì´ ê°€ëŠ¥í•´ì§„ë‹¤


```python
def wr(fun):
    def inn(x):
        fun(x+200)
    return inn
```


```python
@wr
def give_self(x):
    print(x)
```


```python
give_self(1000)
```

    1200
    


```python
def give_self(x):
    print(x)
```


```python
def go_home(fun):
    def inn(*args, **awargs):
        print("I wanna go home..")
        fun(*args, **awargs)
    return inn
```


```python
@go_home
def printing(str):
    print(str)
```


```python
printing("i dont want to study")
```

    I wanna go home..
    i dont want to study
    


```python
@go_home
def printing_2(str1,str2):
    print(str1,str2)
```


```python
printing_2("please","let me")
```

    I wanna go home..
    please let me
    

ì¸ìì™€ ìƒê´€ì—†ì´ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” decorator

`*args`, `**awargs` - ê°€ë³€ í¬ì§€ì…˜ë„ íŒŒë¼ë¯¸í„°, ê°€ë³€ í‚¤ì›Œë“œ íŒŒë¼ë¯¸í„°ë¡œ

ëª¨ë“  ì¸ìë¥¼ ë°›ì„ ìˆ˜ ìˆë„ë¡ í•˜ê²Œ ë§Œë“¤ì–´ ì¤€ë‹¤.


```python
printing_2
```




    <function __main__.printing_2(str1, str2)>



`printing_2`ë¼ëŠ” í•¨ìˆ˜ì˜ ì„¤ëª…ì„ ë³´ê³  ì‹¶ì—ˆìœ¼ë‚˜ go_homeì˜ í•¨ìˆ˜ì˜ ì…ì¥ì—ì„œ ë³´ì—¬ì¤€ë‹¤.


```python
from functools import wraps
```


```python
def go_home(fun):
    @wraps(fun)
    def inn(*args, **awargs):
        print("I wanna go home..")
        fun(*args, **awargs)
    return inn

@go_home
def printing_2(str1,str2):
    print(str1,str2)
    
printing_2("this","works?")
```

    I wanna go home..
    this works?
    


```python
printing_2
```




    <function __main__.printing_2(str1, str2)>



`@wraps`ë¥¼ ì´ìš©í•˜ë©´ ì›ë˜ì˜ í•¨ìˆ˜ì˜ typeì„ í™•ì¸ í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤. 
- debugging í•  ë•Œ í™•ì¸ì„ í•  ë•Œ ë„ì›€ì´ ëœë‹¤.(ì›ë˜ í•¨ìˆ˜ì˜ ì´ë¦„ì„ ì°¾ì•„ì¤Œ) 

`@classmethod`ë¼ëŠ” ë°ì½”ë ˆì´í„°ëŠ” í•¨ìˆ˜ë¥¼ ë°›ì•„ì„œ ìƒˆë¡œìš´ í´ë˜ìŠ¤ë¥¼ ìƒì„±í•˜ì—¬ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤ 

`@staticmethod` staticí•˜ê²Œ namespaceë§Œ ì“°ëŠ” í•¨ìˆ˜ë¡œ ë§Œë“¤ì–´ì¤€ë‹¤

> staticí•˜ë‹¤ëŠ” ê²ƒì„ ì´í•´í•´ì•¼í•  ë“¯ í•©ë‹ˆë‹¤

`@property`ë¥¼ ì‚¬ìš©í•˜ë‹ˆ ()ì—†ì´ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” í•¨ìˆ˜ë¡œ ë³€í™˜í•´ì¤€ë‹¤

```python
@tf.function
@tf.function()
```

ì´ëŸ° í˜•íƒœë„ ì¡´ì¬í•˜ë¯€ë¡œ ì§„ë„ë¥¼ ë”°ë¼ì„œ ê°€ë‹¤ë³´ë©´ ì´í•´í•  ìˆ˜ ìˆì„ ê²ƒ..? ~~~ê°€ì§€ê°€ì§€í•˜ë„¤~~~

## decoratorë¥¼ ë§Œë“œëŠ” ë°©ë²•


```python
def start_wrapper(fun):
    def inner(*args, **kwargs):    # innerì™€ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ì˜ ì¸ìë¥¼ ë§ì¶°ì£¼ì *args
        print('start')
        fun(*args, **kwargs)
    return inner
```


```python
def end_wrapper(fun):
    def inner(*args, **kwargs):    # innerì™€ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ì˜ ì¸ìë¥¼ ë§ì¶°ì£¼ì *args
        fun(*args, **kwargs)
        print('end')
    return inner
```


```python
@start_wrapper
@end_wrapper
def s():
    print('S') 
```


```python
s() 
```

    start
    S
    end
    

í•¨ìˆ˜ ì‹œê·¸ë‹ˆì²˜ì—ì„œ ê°€ê¹Œìš´ ìˆœì„œëŒ€ë¡œ wrapì´ ëœë‹¤ ì¦‰ ìˆœì„œë¥¼ ë”°ì§€ìë©´

```python 
printS = end_wrapper(printS) 
printS = start_wrapper(printS)
```
ë¥¼ ìˆ˜í–‰í•˜ëŠ” ê²ƒê³¼ ê°™ì€ ê²°ê³¼ë¥¼ ë‚˜íƒ€ë‚´ë¯€ë¡œ

```python
def start_wrapper(fun):           # 1
    def inner(*args, **kwargs):   # 8
        print('start')            # 11
        fun(*args, **kwargs)      # 12
    return inner                  # 9

def end_wrapper(fun):             # 2
    def inner(*args, **kwargs):   # 5
        fun(*args, **kwargs)      # 13
        print('end')              # 14 
    return inner                  # 6

@start_wrapper                    # 7
@end_wrapper                      # 4
def printS(string):               # 3
    print('String : ', string)    # 15
printS(' thank you ')             # 10

# Out : 
# start
# String : thank you
# end
```

3ì¤‘í•¨ìˆ˜ì˜ êµ¬ì¡°ê°€ ì´ 3ê°€ì§€ ì¡´ì¬í•œë‹¤.

1. ë‹¤ìŒê³¼ ê°™ì´ wrapperì— ì¸ìë¥¼ ë„˜ê²¨ì£¼ê³  ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. 


```python
def input_(x):
    def wrapper(fun):
        def inner(*args, **kwargs):
            fun(*args, **kwargs)
            print('end', x)
        return inner
    return wrapper
```


```python
@input_(3)
def s():
    print('S')
```


```python
s()
```

    S
    end 3
    

ê¸°ì¡´ì— ì¡´ì¬í•˜ëŠ” í•¨ìˆ˜ì˜ ì¼ë¶€ë¶„ì„ ë°”ê¾¸ëŠ” `partial` ê¸°ëŠ¥ë„ í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë°ì— ì‚¬ìš©ë˜ëŠ” í•¨ìˆ˜ë“¤ì„ ë‹´ë‹¹í•˜ëŠ” `functools`ì— ì¡´ì¬

ê°„ëµí•œ ì˜ˆì‹œë¥¼ ë³´ì


```python
from functools import partial
import seaborn as sns
```


```python
iris = sns.load_dataset('iris')
```


```python
iris.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
      <th>species</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.6</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>3.6</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
  </tbody>
</table>
</div>




```python
iris.head = partial(iris.head, n=10)
```


```python
iris.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
      <th>species</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.6</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>3.6</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5.4</td>
      <td>3.9</td>
      <td>1.7</td>
      <td>0.4</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>6</th>
      <td>4.6</td>
      <td>3.4</td>
      <td>1.4</td>
      <td>0.3</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>7</th>
      <td>5.0</td>
      <td>3.4</td>
      <td>1.5</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>8</th>
      <td>4.4</td>
      <td>2.9</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>9</th>
      <td>4.9</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.1</td>
      <td>setosa</td>
    </tr>
  </tbody>
</table>
</div>



ëª¨ë“  ì¸ìŠ¤í„´ìŠ¤ë¥¼ í•¨ìˆ˜ì²˜ëŸ¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

ì´ê²ƒì„ ì˜ í™œìš©í•œë‹¤ë©´, decoratorì˜ ì²«ë²ˆì¨° ê´„í˜¸ì—ëŠ” í•¨ìˆ˜ë¥¼ ë°›ì„ ìˆ˜ ìˆê²Œ ë§Œë“¤ê³  ë‘ë²ˆì§¸ ê´„í˜¸ì—ëŠ” í•¨ìˆ˜ì˜ ì¸ìë¥¼ ë§Œë“¤ë©´ class decoratorë¥¼ ë§Œë“¤ ìˆ˜ ìˆê²Œ ëœë‹¤!


```python
class A:
    def __init__(self):
        print('init activated')
    def __call__(self):
        print('call activated')
```


```python
a = A() # instaceê°€ í•¨ìˆ˜ì²˜ëŸ¼ ì‚¬ìš©ì´ ë˜ëŠ” ê²ƒ
# A(__init__)(__call__) ì„ ì‘ë™
```

    init activated
    


```python
a()
```

    call activated
    

í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë°ì€ ì™œ ì˜ë¯¸ê°€ ìˆëŠ”ê°€
- ì•„ì£¼ ê°„ë‹¨í•˜ê²Œ ë°ì´í„°ë¥¼ ì •ì¬í•  ìˆ˜ ìˆê²Œ ëœë‹¤ 
    - ì½”ë“œì˜ ê°„ê²°í•¨

<br>

<br>

<br>

*<span style="color:grey">21-07-01 - ë¬¸ì„œ ìƒì„±</span>*
